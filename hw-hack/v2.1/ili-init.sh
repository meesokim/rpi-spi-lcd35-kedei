#!/bin/bash

echo -en "   Inserting fbtft_device kernel module with custom init & GPIO config... "
modprobe fbtft_device \
custom \
name=fb_ili9481 \
width=320 height=480 \
speed=16000000 cs=1 gpios=reset:27,dc:22 \
rotate=90 \
init=\
-1,0x00,\
-2,80,\
-1,0xB0,0x00,\
-1,0x11,\
-2,80,\
-1,0xB3,0x02,0x00,0x00,0x00,\
-1,0xC0,0x10,0x3B,0x00,0x02,0x00,0x01,0x00,0x43,\
-1,0xC1,0x08,0x16,0x08,0x08,\
-1,0xC4,0x11,0x07,0x03,0x03,\
-1,0xC6,0x00,\
-1,0xC8,0x03,0x03,0x13,0x5C,0x03,0x07,0x14,0x08,0x00,0x12,0x08,0x14,0x07,0x53,0x0c,0x13,0x03,0x03,0x21,0x00,\
-1,0x35,0x00,\
-1,0x36,0x28,\
-1,0x3A,0x55,\
-1,0x44,0x00,0x01,\
-1,0xB6,0x00,0x02,0x3B,\
-1,0xD0,0x07,0x07,0x1D,\
-1,0xD1,0x00,0x03,0x00,\
-1,0xD2,0x03,0x14,0x04,\
-1,0xE0,0x1f,0x2C,0x2C,0x0B,0x0C,0x04,0x4C,0x64,0x36,0x03,0x0E,0x01,0x10,0x01,0x00,\
-1,0xE1,0x1f,0x3f,0x3f,0x0f,0x1f,0x0f,0x7f,0x32,0x36,0x04,0x0B,0x00,0x19,0x14,0x0F,\
-1,0xE2,0x0f,0x0f,0x0f,\
-1,0xE3,0x0f,0x0f,0x0f,\
-1,0x13,\
-1,0x29,\
-2,50,\
-1,0xB4,0x00,\
-2,50,-3 verbose=3
#-1,0x2C,\
#-1,0x2A,0x00,0x00,0x01,0xDF,\
#-1,0x2B,0x00,0x00,0x01,0x3F,\
#-1,0x2C,\
#-3 verbose=3

if [ $? -ne 0 ]; then
	echo -e "\033[31mINIT FAILED.\033[0m"
	exit 1
fi

echo -e "\033[32mINIT OK.\033[0m"

